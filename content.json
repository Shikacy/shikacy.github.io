[{"title":"下载Onedrive或Sharepoint分享的文件夹","path":"2023/03/06/downloadfromondrive/","text":"背景因为Onedrive for Business一般是用于商业的，其分享的文件夹一般不能直接转存，必须用户在其域中，但对于白嫖E5等进行互联网分享而言，肯定是不现实的，Onedrive下载单个文件时可以直接下载，对于多个文件或者大文件，则会压缩，并进行多次验证，往往中途会下载失败。至于本身的下载速度慢问题，需要转职魔法师。 解决办法准备 环境：WSL SharePoint Download List Generator：获取文件目录下所有文件直链并导出 Aria2：命令行下载工具，支持续传。 步骤 下载项目中的.txt和.py文件。 安装python依赖包requests：可以使用项目提示命令安装，也可以自行安装（本人pip安装失败）。 获取Real Path：此路径指的不一定是根目录，而是你需要下载的文件目录下的路径，因此需要在Documents后面添加后续路径，否则获取不正确，具体路径可以参考需要下载的当前页面的链接元素。 获取FedAuth cookie：取截止到第一个分号(包括)的所有内容即可。 使用Vscode运行.py文件，按照提示，输入关键信息，即可导出包括所有链接的.txt文本。 复制输出信息里面的aria2c部分，在zsh里面运行即可。 注意事项直接在命令行运行.py文件会报错，因此需要在Vscode中运行。","content":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>因为Onedrive for Business一般是用于商业的，其分享的文件夹一般不能直接转存，必须用户在其域中，但对于白嫖E5等进行互联网分享而言，肯定是不现实的，Onedrive下载单个文件时可以直接下载，对于多个文件或者大文件，则会压缩，并进行多次验证，往往中途会下载失败。至于本身的下载速度慢问题，需要转职魔法师。</p>\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><h3 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h3><ol>\n<li>环境：WSL</li>\n<li><a href=\"https://github.com/HenryzhaoH/sharepoint-batch-download-listgen\">SharePoint Download  List Generator</a>：获取文件目录下所有文件直链并导出</li>\n<li>Aria2：命令行下载工具，<strong>支持续传</strong>。</li>\n</ol>\n<h3 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h3><ol>\n<li>下载<a href=\"https://github.com/HenryzhaoH/sharepoint-batch-download-listgen\">项目</a>中的<code>.txt</code>和<code>.py</code>文件。</li>\n<li>安装python依赖包<code>requests</code>：可以使用项目提示命令安装，也可以自行安装（本人<code>pip</code>安装失败）。</li>\n<li>获取<code>Real Path</code>：此路径指的不一定是根目录，而是你需要下载的文件目录下的路径，因此需要在Documents后面添加后续路径，否则获取不正确，具体路径可以参考需要下载的当前页面的链接元素。</li>\n<li>获取<code>FedAuth cookie</code>：取截止到第一个分号(包括)的所有内容即可。</li>\n<li>使用<strong>Vscode</strong>运行<code>.py</code>文件，按照提示，输入关键信息，即可导出包括所有链接的<code>.txt</code>文本。</li>\n<li>复制输出信息里面的<code>aria2c</code>部分，在<code>zsh</code>里面运行即可。</li>\n</ol>\n<h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><p>直接在命令行运行<code>.py</code>文件会报错，因此需要在Vscode中运行。</p>\n"},{"title":"再入江湖","path":"2023/02/14/make a comeback/","text":"缘起之前的blog由于经常在Mac和WIndows以及Ubuntu之间不停切换，总会重新建立新的环境，因此一直都没正式使用，这次blog采用WSL环境搭建，目前满足个人开发需求，且Windows重装后只需要重新关联WSL即可，非常方便，于是将blog重新捡起。 以上，即是再入江湖。 配置 Ubutun(基于WSL环境) Hexo nexmoe主题 Github托管 个人域名实现 具体过程网络上已有详细方案，此处不再赘述，主要关注过程中遇到的问题。 问题及措施Q1. npm不支持nodejs版本R：Ubuntu默认apt的官方源追求稳定，较最新源落后。 A1：更换nodejs更新源。 A2：使用nvm更新nodejs。","content":"<h2 id=\"缘起\"><a href=\"#缘起\" class=\"headerlink\" title=\"缘起\"></a>缘起</h2><p>之前的blog由于经常在Mac和WIndows以及Ubuntu之间不停切换，总会重新建立新的环境，因此一直都没正式使用，这次blog采用WSL环境搭建，目前满足个人开发需求，且Windows重装后只需要重新关联WSL即可，非常方便，于是将blog重新捡起。</p>\n<p>以上，即是再入江湖。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><ul>\n<li>Ubutun(基于WSL环境)</li>\n<li>Hexo</li>\n<li>nexmoe主题</li>\n<li>Github托管</li>\n<li>个人域名实现</li>\n</ul>\n<p>具体过程网络上已有详细方案，此处不再赘述，主要关注过程中遇到的问题。</p>\n<h2 id=\"问题及措施\"><a href=\"#问题及措施\" class=\"headerlink\" title=\"问题及措施\"></a>问题及措施</h2><h3 id=\"Q1-npm不支持nodejs版本\"><a href=\"#Q1-npm不支持nodejs版本\" class=\"headerlink\" title=\"Q1. npm不支持nodejs版本\"></a>Q1. npm不支持nodejs版本</h3><p>R：Ubuntu默认apt的官方源追求稳定，较最新源落后。</p>\n<p>A1：更换nodejs更新源。</p>\n<p>A2：使用nvm更新nodejs。</p>\n"}]